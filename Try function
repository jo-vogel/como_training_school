
tic()
no_cores <- detectCores() / 2 - 1
cl<-makeCluster(no_cores)
clusterEvalQ(cl, {
  library(glinternet)
  library(dplyr)
}) # parallelisation has own environment, therefore some packages and variables need be loaded again
registerDoParallel(cl)


res<-try(exp(12),silent = T)  

   
model_CV<- foreach (i=1:pix_num,.multicombine=TRUE,.packages="bestglm") %dopar% {
  
  if( class(res)!="try-error")
  {        
  res<-try(bestglm(Xy = data.frame(Training_Data [[i]]), IC = "CV", CVArgs = list(Method = "HTF", K = 10, REP =1000), 
        family=binomial),silent=T)} else{0} 
   
  } 
  
      
stopCluster(cl)
toc()
